new HueOrgan('test organ', banks={'linear': ['T1', 'T2'], 'all': [('T1', 'T2')]}, name='organ', ttime=1, start_bank='linear')
new nice_color_gen_husl(cyan(), name='cyan hue gen')
new IntegratingDiffusor(Diffusor(Rate(period=60.0)), name='diffusor')

new ModulationChain(get('cyan hue gen'), name='mod chain')
new DynamicModulator(get('diffusor'), add_hue_hsv, name='diffusor modulator')
cmd mod chain.append(get('diffusor modulator'))

new ConstantList([0, 0.2], name = 'offset generator')
new DynamicModulator(get('offset generator'), add_hue_hsv, name='offset modulator')
cmd mod chain.append(get('offset modulator'))

new Trigger(Rate(bpm=120.), name='note trig')

new GaussianRandom(120, 20, name='trig jit')
new Twiddler(get('trig jit'),;
    lambda trig, val: setattr(trig,'rate',Rate(bpm=val)),;
    get('note trig'), name='trig jit mut')

run trig jit mut

new ColorOrganist(get('organ'), get('note trig'), get('mod chain'), name='organist')

run organist