new ColorOrgan('test organ', 0, 1, {'linear': 0, 'all': 1}, name='organ')
new nice_color_gen_husl(cyan(), name='cyan hue gen')
new IntegratingDiffusor(Diffusor(Rate(period=480.0)), name='diffusor')

new ModulationChain(get('cyan hue gen'), name='mod chain')
new DynamicModulator(get('diffusor'), add_hue_husl, name='diffusor modulator')
cmd mod chain.append(get('diffusor modulator'))

new ConstantList([0, 0.2], name = 'offset generator')
new DynamicModulator(get('offset generator'), add_hue_husl, name='offset modulator')
cmd mod chain.append(get('offset modulator'))

new Trigger(Rate(bpm=120.), name='note trig')

# new GaussianRandom(120, 20, name='trig jit')
# new Twiddler(get('trig jit'),;
#    lambda trig, val: setattr(trig,'rate',Rate(bpm=val)),;
#    get('note trig'), name='trig jit mut')

#run trig jit mut

new ColorOrganist(get('organ'), get('note trig'), get('mod chain'), name='organist')

run organist